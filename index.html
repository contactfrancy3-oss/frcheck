<script>
    tailwind.config = {
        theme: {
            extend: {
                colors: {
                    'primary-dark': '#0d1117', /* Deep charcoal */
                    'card-bg': '#1f2937',     /* Dark slate gray */
                    'accent-indigo': '#4f46e5', /* Indigo 600 */
                    'text-light': '#E5E7EB',
                    'text-muted': '#9CA3AF',
                },
            }
        }
    }

    // --- Données pour le Marquee Films/Séries (6 items) ---
    const moviePosters = [
        { title: "Film Aventure", img: "https://i.pinimg.com/1200x/a2/71/f0/a271f00df372a3023eac0c6ccfbaf104.jpg" }, 
        { title: "Série Dramatique", img: "https://i.pinimg.com/1200x/40/1b/58/401b58cce54d270793ab01d548a9d0a0.jpg" }, 
        { title: "Contenu Précédent", img: "https://i.pinimg.com/1200x/8f/de/b8/8fdeb8f8cc9b17c0c17cb6c5ae0fd35c.jpg" }, 
        { title: "Contenu D", img: "https://i.pinimg.com/1200x/3f/2c/b4/3f2cb48061007aeeacc4978854bc5248.jpg" },
        { title: "Contenu E", img: "https://i.pinimg.com/1200x/1e/d6/cf/1ed6cfa2d7324f74e755e48330efabe3.jpg" },
        { title: "Contenu F", img: "https://i.pinimg.com/1200x/a3/33/3a/a3333a1a6ff63ebfae883cb60b8792d4.jpg" },
        { title: "Contenu A", img: "https://i.pinimg.com/1200x/77/f6/a3/77f6a3989bd939e3b833132366eb630a.jpg" },
        { title: "Contenu C", img: "https://cdn.dribbble.com/userupload/8296701/file/original-ff6ea546c09163c03b8dd98d109e547d.png" }
    ];

    // --- Données pour le Marquee Sport (10 items) ---
    const wideBannerUrl = "https://i.pinimg.com/736x/1a/1f/7f/1a1f7f48ac4650a604e1ce6c38c405ce.jpg";
    const sportPosters = [
        { title: "Ligue Nationale", img: wideBannerUrl }, // Vertical 
        { title: "Match de Football en Direct", img: "https://i.pinimg.com/1200x/38/57/26/3857266bf73582362363b0fd82637edf.jpg" }, // Vertical
        { title: "NBA Match 1", img: "https://i.pinimg.com/1200x/0c/07/ce/0c07cef4d1b93d89a7122186e0b4e204.jpg" }, // Vertical
        { title: "WC26", img: "https://i.pinimg.com/1200x/b4/33/b7/b433b7edae84bea89d8f0a272e9740d2.jpg" }, // Vertical
        { title: "CAN25", img: "https://i.pinimg.com/1200x/0b/f9/75/0bf975ea0f784c1781e1fe84f8da4b33.jpg" }, // Vertical
        { title: "Tennis", img: "https://i.pinimg.com/1200x/9f/0d/10/9f0d10148b648a070eb80890d85b3bc4.jpg" }, // Vertical
        { title: "Live Football", img: "https://i.pinimg.com/736x/2f/76/78/2f7678847a6e3e75ea72179bfce77c33.jpg" },
        { title: "UFC", img: "https://i.pinimg.com/736x/3a/9a/ac/3a9aacf5326195b3730aebf5e1614078.jpg" },
        { title: "Formule 1", img: "https://i.pinimg.com/1200x/bf/e2/11/bfe2113870ab43cf5971afa659d84fa8.jpg" },
        { title: "NFL", img: "https://i.pinimg.com/736x/21/46/63/214663ea41bcdd4e4b5af5986822d956.jpg" }
    ];

    const channelLogos = [
        { title: "Champions League", img: "https://i.pinimg.com/736x/4a/7b/1b/4a7b1bad501e8af05d5bb793350edca5.jpg" },
        { title: "Europa League", img: "https://i.pinimg.com/1200x/00/03/91/0003917afc826de200f8ca182f7009dc.jpg" },
        { title: "Conferance League", img: "https://i.pinimg.com/1200x/dd/e0/86/dde086aa00ff22a8b1f5931bb8f338b3.jpg" },
        { title: "Premier League", img: "https://i.pinimg.com/1200x/a8/9c/c7/a89cc7f74d03a4082c55f817df5f4379.jpg" },
        { title: "Laliga", img: "https://i.pinimg.com/1200x/1e/04/92/1e0492d9c6b3b0409a62a2d7babc380e.jpg" },
        { title: "Serie A", img: "https://i.pinimg.com/1200x/46/88/fb/4688fb0797c7fbb7ea685235de518bbc.jpg" },
        { title: "Bundesliga", img: "https://i.pinimg.com/1200x/fa/6c/cf/fa6ccffacabcbcf005571ddfcedcfae1.jpg" },
        { title: "Ligue 1", img: "https://i.pinimg.com/736x/06/54/fb/0654fb50dc2c1b372a5d8f8196a7d14d.jpg" }
    ];

    // --- Fonctions de l'application (Modale, etc.) ---
    function showModal(title, message) {
        const modal = document.getElementById('custom-modal');
        document.getElementById('modal-title').textContent = title;
        document.getElementById('modal-message').textContent = message;
        modal.classList.remove('hidden');
    }

    function closeModal() {
        document.getElementById('custom-modal').classList.add('hidden');
    }
    
    // --- UPDATED and IMPROVED Subscription Click Handler ---
    function handleSubscriptionClick(planName, adultPackId) {
        const emailAddress = "contactfrancy3@gmail.com";
        let subject = `Demande d'abonnement FrancyHostinger - Forfait ${planName}`;
        let body = `Bonjour,\n\nJe suis intéressé(e) par le forfait ${planName} que j'ai vu sur votre site web.\n\nVeuillez me fournir les détails pour finaliser l'abonnement et le paiement.\n\nCordialement,`;

        const adultPackCheckbox = document.getElementById(adultPackId);
        if (adultPackCheckbox && adultPackCheckbox.checked) {
            subject = `Demande d'abonnement FrancyHostinger - Forfait ${planName} + Pack Adulte`;
            body = `Bonjour,\n\nJe suis intéressé(e) par le forfait ${planName} avec le Pack Adulte optionnel que j'ai vu sur votre site web.\n\nVeuillez me fournir les détails pour finaliser l'abonnement et le paiement.\n\nCordialement,`;
        }

        // 1. Try to open the mailto link (works for users with a default email client)
        window.location.href = `mailto:${emailAddress}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

        // 2. Show the modal as a fallback and for confirmation
        showSubscriptionModal(planName, emailAddress);
    }

    function showSubscriptionModal(planName, emailAddress) {
        const modal = document.getElementById('subscription-modal');
        const titleElement = document.getElementById('subscription-modal-title');
        const messageElement = document.getElementById('subscription-modal-message');
        const emailLinkElement = document.getElementById('subscription-modal-email');

        titleElement.textContent = `Demande pour le forfait "${planName}"`;
        messageElement.textContent = "Nous essayons d'ouvrir votre application de messagerie. Si rien ne se passe, veuillez copier l'adresse email ci-dessous et nous contacter directement.";
        emailLinkElement.textContent = emailAddress;
        emailLinkElement.href = `mailto:${emailAddress}`;

        modal.classList.remove('hidden');
    }

    function closeSubscriptionModal() {
        document.getElementById('subscription-modal').classList.add('hidden');
    }
    
    // --- CORRECTED: Rewritten carousel logic for better control and performance ---
    function initializeCarousel(trackId, items, durationSeconds) {
        const track = document.getElementById(trackId);
        if (!track) return;

        const prevBtn = document.getElementById(trackId.replace('-track', '-prev-btn'));
        const nextBtn = document.getElementById(trackId.replace('-track', '-next-btn'));

        // Duplicate items for infinite scroll effect
        const duplicatedItems = [...items, ...items];
        track.innerHTML = duplicatedItems.map(item => `
            <div class="${item.class}">
                <img src="${item.img}" loading="lazy" onerror="this.onerror=null; this.src='https://placehold.co/${item.width}x${item.height}/324C9E/F7F8FB/png?text=Erreur+Image';" alt="${item.alt}" class="w-full h-full ${item.objectFit}">
            </div>
        `).join('');

        let autoScrollInterval;
        let isPaused = false;
        let scrollAmount;

        const startAutoScroll = () => {
            // IMPORTANT: Calculate scroll amount based on the actual rendered width
            const totalScrollDistance = track.scrollWidth / 2;
            const intervalDuration = 20; // ms (for ~50fps)
            scrollAmount = totalScrollDistance / (durationSeconds * (1000 / intervalDuration));

            if (autoScrollInterval) clearInterval(autoScrollInterval);
            autoScrollInterval = setInterval(() => {
                if (!isPaused) {
                    track.scrollLeft += scrollAmount;
                    // Reset to start when reaching the end of the first set
                    if (track.scrollLeft >= totalScrollDistance) {
                        track.scrollLeft = 0;
                    }
                }
            }, intervalDuration);
        };

        const pauseAutoScroll = () => { isPaused = true; };
        const resumeAutoScroll = () => { isPaused = false; };

        // Button navigation
        const scrollBy = (amount) => {
            pauseAutoScroll();
            track.scrollLeft += amount;
            setTimeout(resumeAutoScroll, 3000); // Resume after 3 seconds
        };

        if (prevBtn) prevBtn.addEventListener('click', () => scrollBy(-500)); // Scroll by one item
        if (nextBtn) nextBtn.addEventListener('click', () => scrollBy(500));  // Scroll by one item

        // Pause on hover
        track.addEventListener('mouseenter', pauseAutoScroll);
        track.addEventListener('mouseleave', resumeAutoScroll);

        // Pause on touch/drag
        track.addEventListener('touchstart', pauseAutoScroll);
        track.addEventListener('touchend', () => setTimeout(resumeAutoScroll, 3000));
        
        track.addEventListener('mousedown', pauseAutoScroll);
        track.addEventListener('mouseup', () => setTimeout(resumeAutoScroll, 3000));
        
        // Start the animation
        startAutoScroll();
    }

    // --- CORRECTED: Refactored initialization functions to use the new generic carousel logic ---
    function initializeWideMarquee(trackId, posters, durationSeconds) {
        const items = posters.map(poster => ({
            img: poster.img,
            alt: `Affiche ${poster.title}`,
            class: 'wide-poster-item poster-card',
            objectFit: 'object-cover',
            width: 1600, // For placeholder
            height: 900  // For placeholder
        }));
        initializeCarousel(trackId, items, durationSeconds);
    }

    function initializeVerticalMarquee(trackId, posters, durationSeconds) {
        const items = posters.map(poster => {
            const objectFit = poster.img === wideBannerUrl ? 'object-contain bg-primary-dark' : 'object-cover';
            return {
                img: poster.img,
                alt: `Affiche ${poster.title}`,
                class: 'vertical-poster-item poster-card',
                objectFit: objectFit,
                width: 400, // For placeholder
                height: 600 // For placeholder
            };
        });
        initializeCarousel(trackId, items, durationSeconds);
    }

    function initializeChannelMarquee(trackId, logos, durationSeconds) {
        const items = logos.map(logo => ({
            img: logo.img,
            alt: `Logo de la ${logo.title}`,
            class: 'square-channel-item',
            objectFit: 'object-cover',
            width: 180, // For placeholder
            height: 180 // For placeholder
        }));
        initializeCarousel(trackId, items, durationSeconds);
    }
    
    // --- Intersection Observer for fade-in animations ---
    const observerOptions = {
        root: null,
        rootMargin: '0px',
        threshold: 0.1
    };

    const observer = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('is-visible');
                observer.unobserve(entry.target);
            }
        });
    }, observerOptions);

    // Lancement après le chargement du DOM
    window.addEventListener('load', () => {
        lucide.createIcons(); 

        // CORRECTED: Initialize carousels with the fixed logic
        initializeWideMarquee('movies-marquee-track', moviePosters, 30); 
        initializeVerticalMarquee('sports-marquee-track', sportPosters, 50); 
        initializeChannelMarquee('channels-marquee-track', channelLogos, 10); 

        // Observe all pricing cards for animation
        document.querySelectorAll('.pricing-card').forEach(card => {
            observer.observe(card);
        });

        // Mobile menu logic (Updated for slide-out menu)
        const menuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-side-menu');
        const closeButton = document.getElementById('mobile-menu-close-btn');

        const openMenu = () => {
            mobileMenu.classList.add('is-open');
        };

        const closeMenu = () => {
            mobileMenu.classList.remove('is-open');
        };

        menuButton.addEventListener('click', openMenu);
        closeButton.addEventListener('click', closeMenu);
        
        // Close menu when clicking on links
        mobileMenu.querySelectorAll('a').forEach(link => {
            link.addEventListener('click', closeMenu);
        });
        
        // Close menu when pressing Escape key
        document.addEventListener('keydown', (event) => {
            if (event.key === 'Escape') {
                closeMenu();
            }
        });
    });
</script>